<!-- 插件配置文件。阅读更多：https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin>
    <!-- 插件的唯一标识符。必须在全球范围内唯一，通常使用反写域名格式。 -->
    <id>org.jetbrains.plugins.template</id>
    <!-- 插件在插件市场和 IDE 设置中显示的名称。 -->
    <name>OverCode</name>
    <!-- 插件的开发商或作者信息。 -->
    <vendor>GuoFan</vendor>

    <!-- 依赖声明。com.intellij.modules.platform 表示该插件依赖于所有 IntelliJ IDE 共有的基础平台功能。 -->
    <depends>com.intellij.modules.platform</depends>

    <!-- 国际化资源包。指向 src/main/resources/messages/MyBundle.properties，用于管理多语言文案。 -->
    <resource-bundle>messages.MyBundle</resource-bundle>

    <!-- 扩展点 (Extensions) 注册。这是插件功能的核心入口，用于声明工具窗口、启动活动、服务等。 -->
    <extensions defaultExtensionNs="com.intellij">

        <!-- Over Code 聊天界面工具窗口 -->
        <toolWindow factoryClass="com.github.bboygf.over_code.ui.home.OverCoderHomeWindowFactory"
                    id="Over Code"
                    anchor="right"
                    icon="AllIcons.Toolwindows.ToolWindowMessages"/>
        
        <!-- 注册一个在项目打开并启动完成后执行的任务 -->
        <postStartupActivity implementation="com.github.bboygf.over_code.startup.InitProjectActivity" />
        
        <!-- 注册模型配置设置页面 -->
        <projectConfigurable
                parentId="tools"
                provider="com.github.bboygf.over_code.ui.model_config.ModelConfigurableProvider"
                id="com.github.bboygf.over_code.ui.model_config.ModelConfigurable"
                displayName="Over Code 模型配置"/>
    </extensions>

    <!-- 动作 (Actions) 注册。用于声明菜单项、工具栏按钮、快捷键操作等。 -->
    <actions>

        
        <!-- 询问AI - 将选中的代码发送到聊天窗口 -->
        <action id="com.github.bboygf.over_code.AskAIAction"
                class="com.github.bboygf.over_code.actions.AskAIAction"
                text="询问 AI (解释代码)"
                description="将选中的代码发送到 Over Code 聊天窗口，让 AI 帮你解释代码的意思">
            <!-- 添加到编辑器代码区的右键菜单（置顶显示） -->
            <add-to-group group-id="EditorPopupMenu" anchor="first"/>
            <!-- 添加快捷键：Ctrl+Alt+A -->
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt A"/>
        </action>

        <!-- 翻译 - 送入聊天窗口 -->
        <action id="com.github.bboygf.over_code.TranslateInChatAction"
                class="com.github.bboygf.over_code.actions.TranslateInChatAction"
                text="翻译 (发送到聊天)"
                description="将选中的文本发送到 Over Code 聊天窗口进行翻译">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="com.github.bboygf.over_code.AskAIAction"/>
        </action>

        <!-- 翻译 - 弹窗显示 -->
        <action id="com.github.bboygf.over_code.QuickTranslateAction"
                class="com.github.bboygf.over_code.actions.QuickTranslateAction"
                text="快速翻译 (弹窗显示)"
                description="在选中位置下方弹出翻译结果">
            <add-to-group group-id="EditorPopupMenu" anchor="after" relative-to-action="com.github.bboygf.over_code.TranslateInChatAction"/>
            <keyboard-shortcut keymap="$default" first-keystroke="ctrl alt T"/>
        </action>
    </actions>
</idea-plugin>
